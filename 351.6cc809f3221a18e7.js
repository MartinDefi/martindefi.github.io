"use strict";(self.webpackChunkapp_titi_frontend=self.webpackChunkapp_titi_frontend||[]).push([[351],{28321:(b,g,s)=>{function h(){const n=(new Date).getTime(),l=[];let u=36e5*parseInt(n/36e5+"");for(let c=0;c<720;c++)l.push(u),u-=36e5;return l}function v(){const n=(new Date).getTime(),l=[];let u=864e5*parseInt(n/864e5+"");for(let c=0;c<30;c++)l.push(u),u-=864e5;return l}function U(){const n=(new Date).getTime();return 86400*parseInt(n/864e5+"")-2592e3}function R(o){return o>0?[parseInt(o/864e5+"")+"d",parseInt(o%864e5/36e5+"")+"h",parseInt(o%36e5/6e4+"")+"m",parseInt(o%6e4/1e3+"")+"s"].join(":"):[" -- d"," -- h"," -- m"," -- s"].join(":")}function w(o){let n=o;const l=n.substring(0,1),u=n.substring(1,2);if(n.length>1&&"0"===l&&"."!==u&&(n=n.substring(1,2)),"."===l&&(n=""),-1!==n.indexOf(".")){let c=n.substring(n.indexOf(".")+1);-1!==c.indexOf(".")&&(n=n.substring(0,n.indexOf(".")+c.indexOf(".")+1))}return n=n.replace(/[^\d^\.]+/g,""),n}function t(o){let n=w(o);return n=n.replace(/^(\-)*(\d+)\.(\d\d\d\d).*$/,"$1$2.$3").replace(".",""),n}s.d(g,{jn:()=>h,Gq:()=>v,Mv:()=>U,lR:()=>R,Y4:()=>w,uM:()=>t})},10351:(b,g,s)=>{s.r(g),s.d(g,{ActivityModule:()=>M});var h=s(69808),v=s(91083),U=s(5963),R=s(54004),w=s(28321),t=s(5e3),o=s(31657),n=s(32681),l=s(47423),u=s(68326),c=s(85899),D=s(75303);function m(a,p){if(1&a&&(t.TgZ(0,"div"),t._UZ(1,"mat-progress-bar",14),t.qZA()),2&a){const e=t.oxw().$implicit,r=t.oxw();t.xp6(1),t.Q6J("value",r.activityData[e.uuid])}}function S(a,p){if(1&a&&(t.TgZ(0,"div",15),t._uU(1),t.ALo(2,"async"),t.qZA()),2&a){const e=t.oxw().$implicit,r=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,r.activityData[e.uuid])," ")}}function i(a,p){if(1&a&&(t.TgZ(0,"div",15),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit,r=t.oxw();t.xp6(1),t.hij(" ",r.activityData[e.uuid]," ")}}function d(a,p){if(1&a&&(t.TgZ(0,"div",15),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&a){const e=t.oxw().$implicit,r=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,r.activityData[e.uuid],4)," TiTi ")}}function _(a,p){if(1&a&&(t.TgZ(0,"div",10),t.TgZ(1,"div",11),t._uU(2),t.qZA(),t.YNc(3,m,2,1,"div",12),t.YNc(4,S,3,3,"div",13),t.YNc(5,i,2,1,"div",13),t.YNc(6,d,3,4,"div",13),t.qZA()),2&a){const e=p.$implicit;t.xp6(2),t.hij("",e.lable,":"),t.xp6(1),t.Q6J("ngIf","processbar"===e.type),t.xp6(1),t.Q6J("ngIf","countdown"===e.type),t.xp6(1),t.Q6J("ngIf","common"===e.type),t.xp6(1),t.Q6J("ngIf","decimal"===e.type)}}const y=16461792e5,A=[{path:"",component:(()=>{class a{constructor(e,r,f,P){this.refreshService=e,this.activedRoute=r,this.location=f,this.use2earnService=P,this.activityName=""}getCounter(e){const r=new Date(e);return(0,U.H)(0,1e3).pipe((0,R.U)(()=>(0,w.lR)(r.getTime()-(new Date).getTime())))}ngOnInit(){this.initData(),this.unregister=this.refreshService.registerFunction(()=>this.initData())}ngOnDestroy(){this.unregister()}initData(){this.fetchUserData().then(()=>this.getActivityInfo()).then(()=>this.getActivityData()).then(e=>this.rebuildData(e)).then(e=>this.activityData=e)}fetchUserData(){return this.use2earnService.fetchUserData()}getActivityInfo(){return this.activityName=this.activedRoute.snapshot.paramMap.get("activityName"),fetch(`/assets/activity/${this.activityName}.json`).then(e=>e.text()).then(e=>this.activityInfo=JSON.parse(e))}getActivityData(){let e={};const r=(new Date).getTime();switch(this.activityName){case"buyTiUSD":e={activityProgress:r-y<2592e6?100*(r-y)/2592e6:100,activityCountdown:y+2592e6,totalRewards:this.use2earnService.buyTiUSDReward,claimableRewards:this.use2earnService.buyTiUSDPersonalReward};break;case"useTiUSD":e={activityProgress:r-y<2592e6?100*(r-y)/2592e6:100,activityCountdown:y+2592e6,totalRewards:this.use2earnService.transferTiUSDReward,claimableRewards:this.use2earnService.transferTiUSDPersonalReward};break;case"holdTiUSD":e={activityProgress:r-y<2592e6?100*(r-y)/2592e6:100,activityCountdown:y+2592e6,totalRewards:this.use2earnService.holdTiUSDReward,claimableRewards:this.use2earnService.holdTiUSDPersonalReward};break;case"buyTiTi":e={activityProgress:r-y<2592e6?100*(r-y)/2592e6:100,activityCountdown:y+2592e6,totalRewards:this.use2earnService.buyTiTiReward,claimableRewards:this.use2earnService.buyTiTiPersonalReward}}return e}rebuildData(e){var r;return null===(r=this.activityInfo)||void 0===r||r.metadata.forEach((f,P)=>{"countdown"===f.type&&(e[f.uuid]=this.getCounter(e[f.uuid]))}),e}goBack(){this.location.back()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(o.g),t.Y36(v.gz),t.Y36(h.Ye),t.Y36(n.Q))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity"]],decls:16,vars:3,consts:[[1,"activity-wrapper"],[1,"activity-card","mat-elevation-z4"],[1,"activity-title"],["mat-button","","color","primary",1,"back-btn",3,"click"],[2,"margin-right","4px"],[1,"activity-data-wrapper"],["class","activity-data-item",4,"ngFor","ngForOf"],[1,"divider"],[1,"desc-title"],[1,"descripion"],[1,"activity-data-item"],[1,"lable"],[4,"ngIf"],["class","value",4,"ngIf"],["mode","determinate",3,"value"],[1,"value"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return r.goBack()}),t.TgZ(4,"mat-icon",4),t._uU(5,"arrow_back"),t.qZA(),t._uU(6," back "),t.qZA(),t.TgZ(7,"h1"),t._uU(8),t.qZA(),t.qZA(),t.TgZ(9,"div",5),t.YNc(10,_,7,5,"div",6),t.qZA(),t._UZ(11,"div",7),t.TgZ(12,"p",8),t._uU(13,"Tips:"),t.qZA(),t.TgZ(14,"p",9),t._uU(15),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(8),t.Oqu(null==r.activityInfo?null:r.activityInfo.name),t.xp6(2),t.Q6J("ngForOf",null==r.activityInfo?null:r.activityInfo.metadata),t.xp6(5),t.Oqu(null==r.activityInfo?null:r.activityInfo.description))},directives:[l.lW,u.Hw,h.sg,h.O5,c.pW],pipes:[h.Ov,D.p],styles:[".activity-wrapper[_ngcontent-%COMP%]{padding:12px 36px 12px 12px;width:100%;min-height:calc(100vh - 200px);box-sizing:border-box}.activity-card[_ngcontent-%COMP%]{padding:60px 12px 12px}.titi-dark-theme[_nghost-%COMP%]   .divider[_ngcontent-%COMP%], .titi-dark-theme   [_nghost-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;width:100%;margin:16px 0;background:linear-gradient(90deg,rgba(255,255,255,0),#0F5F4F,rgba(255,255,255,0))}.divider[_ngcontent-%COMP%]{height:1px;width:100%;margin:16px 0;background:#dafff8}.activity-title[_ngcontent-%COMP%]{width:90%;display:flex;align-items:center;justify-content:center}.back-btn[_ngcontent-%COMP%]{position:absolute;left:36px;top:36px}.desc-title[_ngcontent-%COMP%]{margin-left:12px;color:#00c997}.descripion[_ngcontent-%COMP%]{padding:4px 12px;font-size:8px;word-wrap:break-word;word-break:break-all;white-space:pre-line;overflow-x:hidden;overflow-y:scroll}.activity-data-wrapper[_ngcontent-%COMP%]{padding:12px;width:60%;margin:0 15%}.activity-data-item[_ngcontent-%COMP%]{margin:28px 0;display:grid;font-size:18px;grid-template-columns:50% 50%;align-items:center}.activity-data-item[_ngcontent-%COMP%]   .lable[_ngcontent-%COMP%]{justify-self:start;align-self:center}.activity-data-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{justify-self:end;align-self:center;color:#2b9177}.titi-dark-theme[_nghost-%COMP%]   .value[_ngcontent-%COMP%], .titi-dark-theme   [_nghost-%COMP%]   .value[_ngcontent-%COMP%]{color:#00ffea}@media screen and (max-width: 1024px){.activity-wrapper[_ngcontent-%COMP%]{width:100%;padding:12px;box-sizing:border-box}.activity-card[_ngcontent-%COMP%]{padding:60px 12px 12px}.activity-title[_ngcontent-%COMP%]{width:100%}.activity-data-wrapper[_ngcontent-%COMP%]{width:100%;box-sizing:border-box}.back-btn[_ngcontent-%COMP%]{position:absolute;left:12px;top:36px}.activity-data-wrapper[_ngcontent-%COMP%]{padding:12px;width:100%;margin:0;box-sizing:border-box}.descripion[_ngcontent-%COMP%]{box-sizing:border-box}}"]}),a})()}];let x=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[v.Bz.forChild(A)],v.Bz]}),a})();var O=s(87841);let M=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.ez,x,c.Cv,u.Ps,l.ot,O.m]]}),a})()},32681:(b,g,s)=>{s.d(g,{Q:()=>D});var h=s(70022),v=s(94528),U=s(32856),R=s(5e3),w=s(94602);const t=16461792e5,n=3e7,l=3e7,u=2592e6,c=3e7;let D=(()=>{class m{constructor(i){this.accountService=i,this.buyTiUSDReward=n,this.buyTiUSDPersonalReward=0,this.buyTiUSDRewardRate=n/30,this.buyTiUSDPersonalRewardRate=0,this.transferTiUSDReward=l,this.transferTiUSDPersonalReward=0,this.transferTiUSDRewardRate=l/30,this.transferTiUSDPersonalRewardRate=0,this.holdTiUSDReward=u,this.holdTiUSDPersonalReward=0,this.holdTiUSDRewardRate=u/30,this.holdTiUSDPersonalRewardRate=0,this.buyTiTiReward=c,this.buyTiTiPersonalReward=0,this.buyTiTiRewardRate=c/30,this.buyTiTiPersonalRewardRate=0,this.totalClaimableRewards=0,this.distributedTiTiRewards=0,this.APIURL="/subgraphs/name/OOKURUMI/titi-use2earn",this.client=new h.f({uri:this.APIURL,cache:new v.h})}fetchUserData(){return this.fetchUserDailyData().then(({data:i})=>{this.buyTiUSDPersonalReward=0,this.transferTiUSDPersonalReward=0,this.holdTiUSDPersonalReward=0,this.buyTiTiPersonalReward=0,this.buyTiUSDPersonalRewardRate=0,this.transferTiUSDPersonalRewardRate=0,this.holdTiUSDPersonalRewardRate=0,this.buyTiTiPersonalRewardRate=0,i.user.dailyUserMint.forEach(d=>{this.buyTiUSDPersonalReward+=this.buyTiUSDRewardRate*d.dailyVolume/d.dailyMint.dailyTotalVolume}),i.user.dailyUserTransfer.forEach(d=>{this.transferTiUSDPersonalReward+=this.transferTiUSDRewardRate*d.dailyVolume/d.dailyTransfer.dailyTotalVolume}),this.holdTiUSDPersonalReward=1*i.user.rewards+i.user.balance*(this.rewardPerToken(i.holder)-i.user.userRewardPerTokenPaid)/10**18,i.user.dailyUserSwap.forEach(d=>{this.buyTiTiPersonalReward+=this.buyTiTiRewardRate*d.dailyVolume/d.dailySwap.dailyTotalVolume}),this.buyTiUSDPersonalRewardRate=i.dailyUserMint&&i.dailyUserMint.dailyMint.dailyTotalVolume?this.buyTiUSDRewardRate*i.dailyUserMint.dailyVolume/i.dailyUserMint.dailyMint.dailyTotalVolume:0,this.transferTiUSDPersonalRewardRate=i.dailyUserTransfer&&i.dailyUserTransfer.dailyTransfer.dailyTotalVolume?this.transferTiUSDRewardRate*i.dailyUserTransfer.dailyVolume/i.dailyUserTransfer.dailyTransfer.dailyTotalVolume:0,this.buyTiTiPersonalRewardRate=i.dailyUserSwap&&i.dailyUserSwap.dailySwap.dailyTotalVolume?this.buyTiTiRewardRate*i.dailyUserSwap.dailyVolume/i.dailyUserSwap.dailySwap.dailyTotalVolume:0,this.holdTiUSDPersonalRewardRate=this.holdTiUSDRewardRate*i.user.balance/i.holder.totalSupply,this.distributedTiTiRewards=((new Date).getTime()-t)/864e5*(this.buyTiUSDRewardRate+this.transferTiUSDRewardRate+this.holdTiUSDRewardRate+this.buyTiTiRewardRate)})}rewardPerToken(i){return 0===Number.parseInt(i.totalSupply)?i.rewardPerTokenStored:1*i.rewardPerTokenStored+(this.lastTimeRewardApplicable()-i.lastUpdateTime)*this.holdTiUSDRewardRate*10**18/(3600*i.totalSupply*24)}lastTimeRewardApplicable(){let i;const d=(new Date).getTime();return i=d<t?t:d<t+2592e6?d:t+2592e6,i/1e3}fetchUserDailyData(){return this.accountService.getCurrentAccountAsyn().then(d=>this.client.query({query:(0,U.Ps)('\n    query($id: ID,$dayId:ID) {\n      user(id:$id){\n        id\n        address\n        rewards\n        balance\n        userRewardPerTokenPaid\n        dailyUserTransfer{\n          dailyTransfer{\n            dayStartTimestamp\n            dailyTotalVolume\n          }\n          dailyVolume\n        }\n        dailyUserMint{\n          dailyMint{\n            dayStartTimestamp\n            dailyTotalVolume\n          }\n          dailyVolume\n        }\n        dailyUserSwap{\n          dailySwap{\n            dayStartTimestamp\n            dailyTotalVolume\n          }\n          dailyVolume\n        }\n      }\n      holder(id:"1"){\n        lastUpdateTime\n        rewardPerTokenStored\n        totalSupply\n      }\n      dailyUserTransfer(id:$dayId){\n        dailyVolume\n        dailyTransfer{\n          dailyTotalVolume\n        }\n      }\n      dailyUserMint(id:$dayId){\n        dailyVolume\n        dailyMint{\n          dailyTotalVolume\n        }\n      }\n      dailyUserSwap(id:$dayId){\n        dailyVolume\n        dailySwap{\n          dailyTotalVolume\n        }\n      }\n   }\n  '),variables:{id:d.toLowerCase(),dayId:d.toLowerCase()+"-"+Number.parseInt((new Date).getTime()/864e5+"")},fetchPolicy:"network-only"}))}}return m.\u0275fac=function(i){return new(i||m)(R.LFG(w.B))},m.\u0275prov=R.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);