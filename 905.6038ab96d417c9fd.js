"use strict";(self.webpackChunkapp_titi_frontend=self.webpackChunkapp_titi_frontend||[]).push([[905],{13905:(E,U,a)=>{a.r(U),a.d(U,{Use2earnModule:()=>J});var D=a(69808),p=a(91083),t=a(5e3),w=a(32681),P=a(31657),S=a(48966),Z=a(11730),y=a(92134),x=a(47423),l=a(32075),v=a(75303);function g(e,n){1&e&&(t.TgZ(0,"th",20),t._uU(1,"Act."),t.qZA())}function M(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.Oqu(i.act)}}function r(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1,"Total Rewards"),t.qZA())}function d(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,i.total,2)," TiTi")}}function o(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1,"Pending Rewards"),t.qZA())}function u(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,i.personal,2)," TiTi")}}function c(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1,"Expected Daily Rewards"),t.qZA())}function b(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,i.rate,2)," TiTi/Day")}}function f(e,n){1&e&&t._UZ(0,"tr",24)}function R(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"tr",25),t.NdJ("click",function(){const _=t.CHM(i).$implicit;return t.oxw().onRowClick(_)}),t.qZA()}}function A(e,n){1&e&&(t.TgZ(0,"th",20),t._uU(1,"Act."),t.qZA())}function T(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.Oqu(i.act)}}function m(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1,"Total Rewards"),t.qZA())}function h(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,i.total,2)," TiTi")}}function O(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1,"Pending Rewards"),t.qZA())}function F(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,i.personal,2)," TiTi")}}function Y(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1,"Expected Daily Rewards"),t.qZA())}function L(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"numberFormat"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,i.rate,2)," TiTi/Day")}}function N(e,n){1&e&&t._UZ(0,"tr",24)}function I(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"tr",25),t.NdJ("click",function(){const _=t.CHM(i).$implicit;return t.oxw().onRowClick(_)}),t.qZA()}}const k=[{path:"",component:(()=>{class e{constructor(i,s,C,_,B){this.router=i,this.use2earnService=s,this.refreshService=C,this.dialog=_,this.web3Service=B,this.displayedColumns=["act","total","personal","rate"],this.dataSource1=[],this.dataSource2=[],this.clickedRows=new Set}ngOnInit(){this.initData(),this.unregister=this.refreshService.registerFunction(()=>this.initData())}ngOnDestroy(){this.unregister()}initData(){this.fetchUserData().then(()=>this.buildDataSource())}fetchUserData(){return this.use2earnService.fetchUserData()}buildDataSource(){this.dataSource1=[{act:"Buy TiUSD in MAMM",total:this.use2earnService.buyTiUSDReward,personal:this.use2earnService.buyTiUSDPersonalReward,rate:this.use2earnService.buyTiUSDPersonalRewardRate,url:"/use2earn/activity/buyTiUSD"},{act:"TiUSD Holder",total:this.use2earnService.holdTiUSDReward,personal:this.use2earnService.holdTiUSDPersonalReward,rate:this.use2earnService.holdTiUSDPersonalRewardRate,url:"/use2earn/activity/holdTiUSD"}],this.dataSource2=[{act:"Buy TiTi in Uniswap",total:this.use2earnService.buyTiTiReward,personal:this.use2earnService.buyTiTiPersonalReward,rate:this.use2earnService.buyTiTiPersonalRewardRate,url:"/use2earn/activity/buyTiTi"}]}onRowClick(i){this.router.navigateByUrl(i.url)}onClaim(){a.e(797).then(a.bind(a,51797)).then(({TitiStakingModalComponent:i})=>{this.dialog.open(i).afterClosed().subscribe(C=>{this.web3Service.invokeContract("TiTiMerkleDistributor",C?"claim":"claimAndStake",[])})})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(p.F0),t.Y36(w.Q),t.Y36(P.g),t.Y36(S.uw),t.Y36(Z.Uc))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-use2earn"]],decls:60,vars:19,consts:[[1,"use2earn-wrapper"],[1,"mat-elevation-z4","biz-info-card"],[1,"title"],["text","Accumulated TiTi Rewards distributed to use-to-earn behaviors."],[1,"value"],["text","Accural of unclaimable rewards in your account until the distribution is triggered."],["text","Accural of claimable rewards in your account at anytime."],["mat-raised-button","","color","primary",1,"action-btn",3,"disabled","click"],[1,"mat-elevation-z4","activity-table-wrapper"],["mat-table","",1,"activity-table",3,"dataSource"],["matColumnDef","act"],["mat-header-cell","","class"," left-align",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","total"],["mat-header-cell","","class"," right-align",4,"matHeaderCellDef"],["mat-cell","","class"," right-align",4,"matCellDef"],["matColumnDef","personal"],["matColumnDef","rate"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"left-align"],["mat-cell",""],["mat-header-cell","",1,"right-align"],["mat-cell","",1,"right-align"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h2",2),t._uU(3,"Distributed TiTi Rewards"),t._UZ(4,"titi-tooltip",3),t.qZA(),t.TgZ(5,"span",4),t._uU(6),t.ALo(7,"numberFormat"),t.qZA(),t.qZA(),t.TgZ(8,"div",1),t.TgZ(9,"h2",2),t._uU(10,"Your Pending Rewards"),t._UZ(11,"titi-tooltip",5),t.qZA(),t.TgZ(12,"span",4),t._uU(13),t.ALo(14,"numberFormat"),t.qZA(),t.qZA(),t.TgZ(15,"div",1),t.TgZ(16,"h2",2),t._uU(17,"Your Claimable Rewards"),t._UZ(18,"titi-tooltip",6),t.qZA(),t.TgZ(19,"span",4),t._uU(20),t.ALo(21,"numberFormat"),t.qZA(),t.TgZ(22,"button",7),t.NdJ("click",function(){return s.onClaim()}),t._uU(23,"CLAIM"),t.qZA(),t.qZA(),t.TgZ(24,"div",8),t.TgZ(25,"h2"),t._uU(26,"Inter-Protocol Behaviors"),t.qZA(),t.TgZ(27,"table",9),t.ynx(28,10),t.YNc(29,g,2,0,"th",11),t.YNc(30,M,2,1,"td",12),t.BQk(),t.ynx(31,13),t.YNc(32,r,2,0,"th",14),t.YNc(33,d,3,4,"td",15),t.BQk(),t.ynx(34,16),t.YNc(35,o,2,0,"th",14),t.YNc(36,u,3,4,"td",15),t.BQk(),t.ynx(37,17),t.YNc(38,c,2,0,"th",14),t.YNc(39,b,3,4,"td",15),t.BQk(),t.YNc(40,f,1,0,"tr",18),t.YNc(41,R,1,0,"tr",19),t.qZA(),t.qZA(),t.TgZ(42,"div",8),t.TgZ(43,"h2"),t._uU(44,"Ex-Protocol Behaviors"),t.qZA(),t.TgZ(45,"table",9),t.ynx(46,10),t.YNc(47,A,2,0,"th",11),t.YNc(48,T,2,1,"td",12),t.BQk(),t.ynx(49,13),t.YNc(50,m,2,0,"th",14),t.YNc(51,h,3,4,"td",15),t.BQk(),t.ynx(52,16),t.YNc(53,O,2,0,"th",14),t.YNc(54,F,3,4,"td",15),t.BQk(),t.ynx(55,17),t.YNc(56,Y,2,0,"th",14),t.YNc(57,L,3,4,"td",15),t.BQk(),t.YNc(58,N,1,0,"tr",18),t.YNc(59,I,1,0,"tr",19),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(6),t.hij("",t.xi3(7,10,s.use2earnService.distributedTiTiRewards,2)," TiTi"),t.xp6(7),t.hij("",t.xi3(14,13,s.use2earnService.buyTiUSDPersonalReward+s.use2earnService.holdTiUSDPersonalReward+s.use2earnService.buyTiTiPersonalReward,2)," TiTi"),t.xp6(7),t.hij("",t.xi3(21,16,s.use2earnService.totalClaimableRewards,2)," TiTi"),t.xp6(2),t.Q6J("disabled",0===s.use2earnService.totalClaimableRewards),t.xp6(5),t.Q6J("dataSource",s.dataSource1),t.xp6(13),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(4),t.Q6J("dataSource",s.dataSource2),t.xp6(13),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns))},directives:[y.Q,x.lW,l.BZ,l.w1,l.fO,l.Dz,l.as,l.nj,l.ge,l.ev,l.XQ,l.Gk],pipes:[v.p],styles:[".mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid transparent;border-top:1px solid transparent;cursor:pointer}.mat-row[_ngcontent-%COMP%]:hover   .mat-cell[_ngcontent-%COMP%]{border-color:#1de9b6}.use2earn-wrapper[_ngcontent-%COMP%]{padding:12px;display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr 1fr;align-items:center;grid-column-gap:24px;column-gap:24px;grid-row-gap:24px;row-gap:24px}.biz-info-card[_ngcontent-%COMP%]{min-height:120px;padding:18px;grid-column-start:span 2;display:grid;grid-template-columns:1fr 1fr 1fr 1fr}.biz-info-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{grid-column-start:span 4;margin-left:12px}.biz-info-card[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{grid-column-start:span 3;align-self:end;font-size:18px;margin-left:12px}.biz-info-card[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{grid-column-start:span 1}.activity-table-wrapper[_ngcontent-%COMP%]{grid-column-start:span 3;padding:12px;display:flex;align-items:center;flex-direction:column;min-height:360px}.activity-table[_ngcontent-%COMP%]{width:100%;background-color:transparent}.activity-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .activity-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:0 4px}.activity-table[_ngcontent-%COMP%]   .left-align[_ngcontent-%COMP%]{text-align:left}.activity-table[_ngcontent-%COMP%]   .right-align[_ngcontent-%COMP%]{text-align:right}@media screen and (max-width: 1024px){.use2earn-wrapper[_ngcontent-%COMP%]{width:100%;padding:12px;margin:0;display:grid;grid-template-columns:1fr;grid-row-gap:12px;row-gap:12px;grid-column-gap:0;column-gap:0}.biz-info-card[_ngcontent-%COMP%]{width:100%;margin:0;min-height:80px}.activity-table-wrapper[_ngcontent-%COMP%]{width:100%;margin:0;padding:12px}}"]}),e})()}];let z=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.Bz.forChild(k)],p.Bz]}),e})();var Q=a(87841);let J=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[D.ez,z,l.p0,x.ot,Q.m]]}),e})()},11730:(E,U,a)=>{a.d(U,{Uc:()=>x,fV:()=>l,wE:()=>v});var D=a(98538),p=a.n(D),t=a(5e3),w=a(5437),P=a(94602),S=a(57261),Z=a(48966),y=a(31657);let x=(()=>{class g{constructor(r,d,o,u,c){this.web3ModalService=r,this.accountService=d,this._snackBar=o,this.dialog=u,this.refreshService=c,this.badge=0,this.recentTransaction=new Set(JSON.parse(localStorage.getItem("recentTransaction")||"[]"))}clearBadge(){this.badge=0}initWeb3(){return new Promise((r,d)=>{this.web3?(this.web3.currentProvider||this.web3.setProvider(this.web3ModalService.provider),r()):Promise.all([a.e(445).then(a.t.bind(a,34445,23)),this.web3ModalService.getProvider()]).then(([o,u])=>{this.web3=new o.default(u),r()}).catch(d)})}setProvider(r){return this.initWeb3().then(()=>this.web3.setProvider(r))}invokeContract(r,d,o,u){return this.initWeb3().then(()=>Promise.all([this.getFunctionABI(r,d),this.accountService.getCurrentAccountAsyn()]).then(([c,b])=>{const f=this.web3.eth.abi.encodeFunctionCall(c,o),A={from:b,to:v[r],data:f,value:u};if("view"==c.stateMutability)return this.web3.eth.call(A).then(T=>this.web3.eth.abi.decodeParameters(c.outputs,T));{let T="";return this.web3.eth.sendTransaction(A).on("transactionHash",m=>{T=m;const h=Array.from(this.recentTransaction);h.unshift({txHash:m,contractName:r,functionName:d,params:o,receipt:null}),this.recentTransaction=new Set(h),localStorage.setItem("recentTransaction",JSON.stringify(h)),this.badge++}).on("receipt",m=>{this.recentTransaction.forEach(h=>{h.txHash===m.transactionHash&&(h.receipt=m)}),localStorage.setItem("recentTransaction",JSON.stringify(Array.from(this.recentTransaction))),m.status?(this.refreshService.invokeFunctions(),this._snackBar.open("Successful transaction!","close",{horizontalPosition:"center",verticalPosition:"top",duration:3e3})):this._snackBar.open("Transaction failed!","close",{horizontalPosition:"center",verticalPosition:"top",duration:3e3})}).on("error",m=>{this.recentTransaction.forEach(h=>{h.txHash===T&&(h.receipt={status:!1})}),localStorage.setItem("recentTransaction",JSON.stringify(Array.from(this.recentTransaction))),this._snackBar.open("Transaction failed!","close",{horizontalPosition:"center",verticalPosition:"top",duration:3e3})}).then(m=>m)}})).catch(c=>{throw this._snackBar.open("Unknown Error!","close",{horizontalPosition:"center",verticalPosition:"top",duration:3e3}),c})}getFunctionABI(r,d){return fetch(`/assets/abi/${r}.json`).then(o=>o.text()).then(o=>JSON.parse(o).abi).then(o=>{const u=o.filter(c=>c.name==d&&"function"==c.type);if(0===u.length)throw new Error("No such function");return u[0]})}decodeLog(r,d,o){return this.initWeb3().then(()=>this.web3.eth.abi.decodeLog(r,d,o))}openApproveModal(r,d,o,u){this.accountService.getCurrentAccountAsyn().then(c=>this.invokeContract(r,"allowance",[c,v[o]])).then(c=>{d.gt(new(p())(c[0]))?a.e(288).then(a.bind(a,30288)).then(({ApproveModalComponent:b})=>{const f=this.dialog.open(b);f.componentInstance.approveToken=r,f.componentInstance.approveValue=l.toString(),f.componentInstance.approveSpender=o,f.afterClosed().subscribe(u)}):u(!0)})}}return g.\u0275fac=function(r){return new(r||g)(t.LFG(w.y),t.LFG(P.B),t.LFG(S.ux),t.LFG(Z.uw),t.LFG(y.g))},g.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();const l=new(p())("2").pow(new(p())("256")).sub(new(p())("1")),v={TiUSD:"0x6470CBF042B47dDF0Ef0B6E4698d1E07B81E79EB",TiTiToken:"0x58B18861B43B4cD87cd83AD9BB47617D4507e008",USDC:"0x36f0DED0eD08930A78bb0D32574D60a2f030AD5F",MAMMSwapPair:"0x63ea4F07d36E2b430Be0dC10442b0e7dA41172f4",MarketMakerFund:"0x3A952d584948E60E2cA30ABD6F1C4C606d7d1191",MMFLPStakingPool:"0xb7F100c381Bf5cc1f8091Ad6F06723e46a890F66",LPStakingPool:"0x49E49aC492948d57E34A0cb31f47747c4ce6fA88",RainyDayFundVault:"0x7a0b80Bb0966ddaDA2E7B8546D0dB63C77ba449b",ProtocolFeeVault:"0x3e2C38065Db78B62e1c6A73d25E839eF3c4A5E88",ReOrdersController:"0x10c9EbD914582054C09e1785761297A36856Ed7b",TiTiStaking:"0x0f7E1871F4b16087d9536263C531D508Abf37981",UniswapV2Pair:"0x0398404fd77459a6736257cf1D1433cAc0186793",TiTiBackendV1:"0x1447A7b9f0a457115e8bF1CE09b84ec3fC7b1b39",TiTiMerkleDistributor:"0x10e65D6090F188487EEfff54725Bc4b6fF394051"}}}]);